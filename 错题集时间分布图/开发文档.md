# QuizGame 测验系统开发文档

## 1. 项目概述

### 1.1 项目简介

QuizGame 是一个基于 Python 开发的在线测验系统，使用 tkinter 构建图形用户界面。该系统旨在提供一个简单易用、功能完整的在线测验平台，支持多种题型，包括选择题、填空题和判断题。

### 1.2 主要特点

- 🎯 多种题型支持 | ⏱️ 实时计时功能
- 📊 实时得分统计 | 📈 时间分布分析
- 🏆 最高分记录系统 | 👤 学生身份验证
- ⌨️ 键盘快捷键支持

### 1.3 应用场景

- 课堂测验 | 在线考试
- 知识竞赛 | 自我测试

## 2. 系统架构

### 2.1 技术栈

| 技术类型 | 具体实现        | 用途说明      |
| -------- | --------------- | ------------- |
| 编程语言 | Python 3.x      | 核心开发语言  |
| GUI框架  | tkinter         | 图形界面实现  |
| 数据处理 | openpyxl        | Excel文件处理 |
| 文件格式 | Excel (.xlsx)   | 数据存储      |
| 文件格式 | 文本文件 (.txt) | 配置和记录    |

### 2.2 核心模块

#### 2.2.1 QuizGame.py

主程序文件，负责整体流程控制和用户界面实现。

**主要功能：**

- GUI界面构建 | 用户交互处理
- 测验流程管理 | 计时器实现
- 得分统计 | 时间记录
- 键盘事件处理 | 图表显示

**关键类：**

```python
class QuizGame:
    def __init__(self):
        # 初始化GUI和游戏状态
        pass

    def create_login_ui(self):
        # 创建登录界面
        pass

    def show_question(self):
        # 显示题目
        pass

    def check_answer(self):
        # 检查答案
        pass

    def handle_enter_key(self):
        # 处理回车键事件
        pass
```

#### 2.2.2 Exam.py

数据处理模块，负责文件操作和数据管理。

**主要类：**

1. `TxtFile`类

   - 处理文本文件操作 | 读取游戏说明
   - 管理最高分记录

2. `Stu`类

   - 管理学生信息 | 验证学号格式
   - 加载学生名单

3. `QusAndAns`类
   - 处理题库数据 | 随机打乱题目
   - 管理题目分值

## 3. 功能特性

### 3.1 用户认证系统

#### 3.1.1 登录验证

- 学号验证（10位数字） | 姓名完全匹配
- 实时错误提示

#### 3.1.2 安全特性

- 输入数据清理 | 格式验证
- 错误处理机制

### 3.2 测验功能

#### 3.2.1 题型支持

1. **选择题**

   - 支持A-D四个选项 | 选项随机排序
   - 自动评分 | 键盘快捷键支持

2. **填空题**

   - 文本输入 | 答案匹配
   - 解释说明 | 回车键提交

3. **判断题**
   - 对/错选项 | 即时反馈
   - 解析显示 | 回车键提交

#### 3.2.2 计时系统

- 倒计时显示 | 自动提交
- 时间提醒 | 每题用时记录

#### 3.2.3 进度显示

- 题目进度条 | 当前得分
- 剩余时间 | 时间分布图表

### 3.3 数据管理

#### 3.3.1 文件结构

```
QuizGame/
├── 名单.xlsx          # 学生信息
├── Quiz.xlsx          # 题库数据
├── Record.txt         # 最高分记录
└── 小测验游戏说明.txt   # 游戏说明
```

#### 3.3.2 数据格式

1. **名单.xlsx**
   | 列名 | 类型 | 说明 |
   |-----|------|------|
   | 学号 | 文本 | 10位数字 |
   | 姓名 | 文本 | 学生姓名 |

2. **Quiz.xlsx**
   - 测验信息表 | 选择题表
   - 填空题表 | 判断题表

## 4. 用户界面

### 4.1 界面布局

#### 4.1.1 窗口设置

- 尺寸：900x750像素 | 标题：QuizGame 测验系统
- 字体：Arial | 中文字体：SimHei

#### 4.1.2 主要组件

1. **顶部区域**

   - 进度指示器 | 得分显示
   - 计时器

2. **中央区域**

   - 题目显示 | 选项列表
   - 输入框 | 反馈信息

3. **底部区域**
   - 提交按钮 | 下一题按钮
   - 退出按钮

4. **时间分布界面**
   - 柱状图显示 | 每题用时
   - 网格线 | 数值标签

### 4.2 界面流程

#### 4.2.1 登录界面

- 显示测验信息 | 输入学号和姓名
- 验证身份

#### 4.2.2 测验界面

- 显示题目 | 选择/输入答案
- 提交答案 | 显示反馈
- 键盘快捷键 | 时间记录

#### 4.2.3 结果界面

- 显示总分 | 时间分布图表
- 最高分对比

## 5. 开发注意事项

### 5.1 文件依赖

- 确保所有必要文件存在 | 检查文件权限
- 验证文件格式 | 安装matplotlib库

### 5.2 错误处理

- 文件加载异常 | 用户输入验证
- 数据格式检查 | 界面刷新处理

### 5.3 性能优化

- 多线程计时 | Excel文件缓存
- 内存管理 | 界面响应优化

## 6. 部署说明

### 6.1 环境要求

- Python 3.x | tkinter库
- openpyxl库 | Windows操作系统

### 6.2 安装步骤

1. 安装Python环境
2. 安装依赖包：
   ```bash
   pip install openpyxl
   ```
3. 复制必要文件
4. 运行程序：
   ```bash
   python QuizGame.py
   ```

### 6.3 配置说明

- 修改题库：编辑Quiz.xlsx | 更新名单：编辑名单.xlsx
- 自定义说明：编辑小测验游戏说明.txt

## 7. 维护建议

### 7.1 定期维护

- 更新题库内容 | 备份学生数据
- 清理历史记录 | 检查系统日志

### 7.2 扩展建议

1. **功能扩展**

   - 添加更多题型 | 实现成绩分析
   - 添加管理员功能 | 支持在线更新

2. **性能优化**

   - 优化文件读取 | 改进界面响应
   - 增加数据缓存 | 优化内存使用

3. **安全增强**
   - 加密敏感数据 | 增加日志记录
   - 完善错误处理 | 添加数据备份

## 8. 常见问题

### 8.1 安装问题

1. **依赖包安装失败**

   - 检查网络连接 | 更新pip版本
   - 使用国内镜像源

2. **文件缺失**
   - 检查文件路径 | 验证文件权限
   - 重新复制文件

### 8.2 运行问题

1. **界面显示异常**

   - 检查分辨率 | 更新显卡驱动
   - 调整窗口大小

2. **数据加载失败**
   - 检查文件格式 | 验证数据完整性
   - 重新生成文件

---
