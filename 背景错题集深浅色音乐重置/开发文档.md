# QuizGame 测验系统开发文档

## 1. 项目概述

### 1.1 项目简介

QuizGame 是一个基于 Python 开发的在线测验系统，使用 tkinter 构建图形用户界面。该系统旨在提供一个简单易用、功能完整的在线测验平台，支持多种题型，包括选择题、填空题和判断题。

### 1.2 主要特点

- 🎯 多种题型支持 | ⏱️ 实时计时功能
- 📊 实时得分统计 | 🔍 错题回顾功能
- 🏆 最高分记录系统 | 👤 学生身份验证
- 🎨 主题切换功能 | 🖼️ 背景图片支持
- 🔊 音效反馈系统

### 1.3 应用场景

- 课堂测验 | 在线考试
- 知识竞赛 | 自我测试

## 2. 系统架构

### 2.1 技术栈

| 技术类型 | 具体实现        | 用途说明      |
| -------- | --------------- | ------------- |
| 编程语言 | Python 3.x      | 核心开发语言  |
| GUI框架  | tkinter         | 图形界面实现  |
| 数据处理 | openpyxl        | Excel文件处理 |
| 图像处理 | Pillow          | 背景图片处理  |
| 音频处理 | pygame          | 音效播放      |
| 文件格式 | Excel (.xlsx)   | 数据存储      |
| 文件格式 | 文本文件 (.txt) | 配置和记录    |
| 文件格式 | 音频文件 (.wav) | 音效文件      |

### 2.2 核心模块

#### 2.2.1 QuizGame.py

主程序文件，负责整体流程控制和用户界面实现。

**主要功能：**

- GUI界面构建 | 用户交互处理
- 测验流程管理 | 计时器实现
- 得分统计 | 错题记录
- 主题切换 | 背景图片管理
- 音效播放

**关键类：**

```python
class QuizGame:
    def __init__(self):
        # 初始化GUI和游戏状态
        pass

    def create_login_ui(self):
        # 创建登录界面
        pass

    def show_question(self):
        # 显示题目
        pass

    def check_answer(self):
        # 检查答案
        pass

    def toggle_theme(self):
        # 切换主题
        pass

    def import_background(self):
        # 导入背景图片
        pass

    def play_sound(self):
        # 播放音效
        pass
```

#### 2.2.2 Exam.py

数据处理模块，负责文件操作和数据管理。

**主要类：**

1. `TxtFile`类

   - 处理文本文件操作 | 读取游戏说明
   - 管理最高分记录

2. `Stu`类

   - 管理学生信息 | 验证学号格式
   - 加载学生名单

3. `QusAndAns`类
   - 处理题库数据 | 随机打乱题目
   - 管理题目分值

## 3. 功能特性

### 3.1 用户认证系统

#### 3.1.1 登录验证

- 学号验证 | 姓名完全匹配
- 实时错误提示

#### 3.1.2 安全特性

- 输入数据清理 | 格式验证
- 错误处理机制

### 3.2 测验功能

#### 3.2.1 题型支持

1. **选择题**

   - 支持A-D四个选项 | 选项随机排序
   - 自动评分 | 错题记录

2. **填空题**

   - 文本输入 | 答案匹配
   - 解释说明 | 错题记录

3. **判断题**
   - 对/错选项 | 即时反馈
   - 解析显示 | 错题记录

#### 3.2.2 计时系统

- 倒计时显示 | 自动提交
- 时间提醒

#### 3.2.3 错题回顾系统

- 自动记录错题 | 分类存储
- 详细解析显示 | 用户答案对比
- 按题型分类展示 | 清晰的分隔标记

**错题记录结构：**
```python
wrong_questions = {
    "select": [],  # 选择题错题
    "blank": [],   # 填空题错题
    "judge": []    # 判断题错题
}
```

**错题信息包含：**
- 题目内容
- 用户答案
- 正确答案
- 解析说明（选择题）

#### 3.2.4 界面定制

- 深色/浅色主题切换
- 自定义背景图片
- 答题音效反馈

### 3.3 数据管理

#### 3.3.1 文件结构

```
QuizGame/
├── 名单.xlsx          # 学生信息
├── Quiz.xlsx          # 题库数据
├── Record.txt         # 最高分记录
├── 小测验游戏说明.txt   # 游戏说明
├── correct.wav        # 正确答题音效
└── wrong.wav          # 错误答题音效
```

#### 3.3.2 数据格式

1. **名单.xlsx**
   | 列名 | 类型 | 说明 |
   |-----|------|------|
   | 学号 | 文本 | 学生学号 |
   | 姓名 | 文本 | 学生姓名 |

2. **Quiz.xlsx**
   - 测验信息表 | 选择题表
   - 填空题表 | 判断题表

## 4. 用户界面

### 4.1 界面布局

#### 4.1.1 窗口设置

- 尺寸：800x600像素 | 标题：QuizGame 测验系统
- 字体：宋体

#### 4.1.2 主要组件

1. **顶部区域**

   - 主题切换按钮 | 背景导入按钮
   - 计时器

2. **中央区域**

   - 题目显示 | 选项列表
   - 输入框

3. **底部区域**
   - 上一题按钮 | 下一题按钮

4. **错题回顾区域**
   - 分类显示错题
   - 详细解析展示
   - 答案对比显示

### 4.2 界面流程

#### 4.2.1 登录界面

- 显示测验信息 | 输入学号和姓名
- 验证身份

#### 4.2.2 测验界面

- 显示题目 | 选择/输入答案
- 显示反馈 | 播放音效

#### 4.2.3 结果界面

- 显示总分 | 错题回顾
- 最高分对比

## 5. 开发注意事项

### 5.1 文件依赖

- 确保所有必要文件存在 | 检查文件权限
- 验证文件格式

### 5.2 错误处理

- 文件操作异常处理
- 用户输入验证
- 界面响应处理

### 5.3 性能优化

- 图片加载优化
- 音效播放管理
- 内存使用控制

### 5.4 代码规范

- 遵循PEP 8规范
- 添加适当注释
- 模块化设计

## 6. 未来改进

### 6.1 功能扩展

- 更多题型支持
- 题库管理功能
- 成绩统计分析
- 错题导出功能
- 错题练习模式

### 6.2 界面优化

- 响应式布局
- 更多主题选项
- 动画效果

### 6.3 性能提升

- 代码重构
- 数据库支持
- 并发处理

